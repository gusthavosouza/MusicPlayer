<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<style type="text/css">
.fundoStyle {
	background-color: rgba(55, 83, 105, 0.9);
	background-image: -moz-radial-gradient(50% 44%, ellipse cover, rgba(55, 83, 105, 0.9),
		#01101f 62%);
	background-image: -webkit-radial-gradient(50% 44%, ellipse cover, rgba(55, 83, 105, 0.9),
		#01101f 62%);
	background-image: -o-radial-gradient(50% 44%, ellipse cover, rgba(55, 83, 105, 0.9),
		#01101f 62%);
	background-image: -ms-radial-gradient(50% 44%, ellipse cover, rgba(55, 83, 105, 0.9),
		#01101f 62%);
	background-image: radial-gradient(50% 44%, ellipse cover, rgba(55, 83, 105, 0.9),
		#01101f 62%);
}

.testeTrans {
	transform: rotate(180deg);
}

.anime {
	background: rgb(0, 0, 0);
	height: 1px;
}

.imgSty {
	width: 60px;
	height: 60px;
	border-radius: 5%;
	}

.fixedHeader {
	position: fixed;
	width: 100%;
	height: 20%;
	background: black;
	left: 0px;
	top: 0px;
}

.musicStyle {
	display: inline-block;
	width: auto;
	max-width: 120px;
	font-size: 14px;
	font-weight: bold;
	text-overflow: ellipsis;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}
</style>
<script src="jquery/jquery-1.11.1.js"></script>
<script src="dist/id3-minimized.js" type="text/javascript"></script>

<script type="text/javascript">
	var tempo;
	function efeitoMusic() {
		var x = Math.floor((Math.random() * 80) + 1);
		var d = Math.floor((Math.random() * 13) + 1);
		document.getElementById('efe' + d).style.height = x + "px";
		//	var a = Math.floor((Math.random() * 255) + 1);
		//var b = Math.floor((Math.random() * 255) + 1);
		//var c = Math.floor((Math.random() * 255) + 1);
		//document.getElementById('efe'+d).style.backgroundColor = 'rgb(' +a +','+b+','+c+')';
		tempo = setTimeout(efeitoMusic, 10);
	}

	function testando() {
		var b = "algo";
		return b;
	}

	function clearTempo() {
		clearTimeout(tempo);
	}

	function loadFile(input) {

		for (var x = 0; x < input.files.length; x++) {

			var file = input.files[x], url = file.urn || file.name;

			var imgSrc = document.createElement('img');

			ID3.loadTags(url, function(){ imgSrc.src = showTags(url) },
							{
								tags : [ "title", "artist", "album", "picture" ],
								dataReader : FileAPIReader(file)
							});
			createAudio(input.files[x], imgSrc);
		}
	}

	function setAudio(audio) {

		var sound = document.getElementById('playerAudio');
		sound.src = audio;
	}

	function createAudio(file, imgSrc) {
		
		var playList = document.getElementById('playList');

		var tr = document.createElement('tr');

		var td = document.createElement('td');

		var tdImg = document.createElement('td');
		
		var img = imgSrc;

		var music = document.createElement("a");

		var name = document.createTextNode(file.name);
		
		var obj = URL.createObjectURL(file);

		img.setAttribute('class', 'imgSty');

		music.appendChild(name);
		music.setAttribute('hreflang', obj);
		music.setAttribute('onclick', 'setAudio(this.hreflang)');

		music.style.cursor = "pointer";
		music.style.color ="white";
		tdImg.appendChild(img);
		td.appendChild(music);
		tr.appendChild(tdImg);
		tr.appendChild(td);
		playList.appendChild(tr);

	}

	function showTags(url) {

		var tags = ID3.getAllTags(url);

		document.getElementById('title').textContent = tags.title || "";
		document.getElementById('artist').textContent = tags.artist || "";
		document.getElementById('album').textContent = tags.album || "";

		var image = tags.picture;
		var imgSrc = document.createElement('img');
		if (image) {
			var base64String = "";
			for (var i = 0; i < image.data.length; i++) {
				base64String += String.fromCharCode(image.data[i]);
			}
			var base64 = "data:" + image.format + ";base64,"
					+ window.btoa(base64String);
			imgSrc.src = base64;
			document.getElementById('picture').setAttribute('src', base64);

		} else {
			imgSrc.src = "images/album.jpg";
			document.getElementById('picture').src = "images/album.jpg";
		}
		return imgSrc.src;
	}

	function playAudio() {

		var music = document.getElementById('playerAudio');
		music.play();
		efeitoMusic();
	}

	function pauseAudio() {

		var music = document.getElementById('playerAudio');

		music.pause();

		clearTempo();
	}
</script>
</head>
<body>
	<header class="fixedHeader">
	<nav>
	<img alt=""	src="images/choose.png" style="width: 5%; height: 10%; cursor:pointer; position:fixed; left: 2%; top: 2%;"
	onclick="document.getElementById('input').click();">
	<input type="file" id="input" style="display: none;" onchange="loadFile(this);">
	</nav>
	 </header>
	<section
		style="position: fixed; z-index: -1; background: black; width: 50%; height: 65%; left: 0px; top: 20%">
		<output style="color: white;"> Aqui vai o player</output>
		<div id="player">
			<audio id="playerAudio" autoplay="autoplay">
			</audio>
		</div>
		<img alt="" id="picture" src="images/album.jpg"
			style="width: 150px; height: 150px; background: white; top: 30px; position: relative; left: 30px; border-radius: 5px;">
		<div id="infos" style="position: absolute; top: 10px; left: 200px;">
			<table>
				<tr>
					<td><output style="color: white;">Title:</output></td>
					<td><output style="color: white;" id="title">unk</output></td>
				</tr>
				<tr>
					<td><output style="color: white;">Artist:</output></td>
					<td><output style="color: white;" id="artist">unk</output></td>
				</tr>
				<tr>
					<td><output style="color: white;">Album:</output></td>
					<td><output style="color: white;" id="album">unk</output></td>
				</tr>
			</table>
		</div>
	</section>
	
	<section
		style="position: fixed; z-index: -1; background: black; width: 50%; height: 65%; left: 50%; top: 20%"">
		<table id="playList" >
			<tr>
				<td colspan="2"><output style="color: white;"> Aqui vai a List</output></td>
			</tr>
		</table>
	</section>
	<footer
		style="position: fixed; bottom: 0px; width: 100%; height: 15%; background-color: black; left: 0px;">
	</footer>

</body>
</html>